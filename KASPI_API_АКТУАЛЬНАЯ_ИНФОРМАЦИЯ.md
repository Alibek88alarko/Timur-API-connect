# üìã –ê–ö–¢–£–ê–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –ü–û KASPI API (2025)

## üîç –ò–°–¢–û–ß–ù–ò–ö–ò –ò–ù–§–û–†–ú–ê–¶–ò–ò:

### ‚úÖ **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã Kaspi:**
1. **Kaspi –ì–∏–¥ –¥–ª—è –ü–∞—Ä—Ç–Ω–µ—Ä–æ–≤**: https://guide.kaspi.kz/partner/ru/shop/api/
2. **–†–∞–∑–¥–µ–ª API - –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã**: https://guide.kaspi.kz/partner/ru/shop/api/general
3. **–†–∞–∑–¥–µ–ª API - –ó–∞–∫–∞–∑—ã**: https://guide.kaspi.kz/partner/ru/shop/api/orders
4. **–†–∞–∑–¥–µ–ª API - –¢–æ–≤–∞—Ä—ã**: https://guide.kaspi.kz/partner/ru/shop/api/goods
5. **–ö–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞**: https://kaspi.kz/merchantcabinet/ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
6. **–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª**: kaspi API instructions.txt (2157 —Å—Ç—Ä–æ–∫ –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)

---

## üîë –ì–õ–ê–í–ù–û–ï: –ü–†–ê–í–ò–õ–¨–ù–´–ï ENDPOINT'–´

### **–ë–ê–ó–û–í–´–ô URL –î–õ–Ø API:**
```
Host: kaspi.kz
Base URL: /shop/api/v2
```

### **–í–ê–ñ–ù–û! –ü–æ–ª–Ω—ã–π –ø—É—Ç—å:**
```
https://kaspi.kz/shop/api/v2/orders
https://kaspi.kz/shop/api/v2/products
```

**–ù–ï** `https://kaspi.kz/shop/api/v2` (–±–µ–∑ /orders –∏–ª–∏ /products)

---

## üîê –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø:

### **–ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
```http
Content-Type: application/vnd.api+json
X-Auth-Token: <–í–∞—à_—Ç–æ–∫–µ–Ω>
```

### **–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω:**
1. –ó–∞–π–¥–∏—Ç–µ –≤ –∫–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞: https://kaspi.kz/merchantcabinet/
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí API ‚Üí –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω (—Ñ–æ—Ä–º–∞—Ç: base64 —Å—Ç—Ä–æ–∫–∞ ~44 —Å–∏–º–≤–æ–ª–∞)

**–í–∞—à —Ç–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω:**
```
56Pj6wkGBX34/05TUMV1ptxrGCa1ZdMkderQA1+Gtr0=
```

---

## üì¶ –†–ê–ë–û–¢–ê –° –ó–ê–ö–ê–ó–ê–ú–ò:

### **1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤:**

**Endpoint:**
```http
GET /shop/api/v2/orders
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: <—Ç–æ–∫–µ–Ω>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|----------|--------|
| `page[number]` | –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Å 0) | 0 |
| `page[size]` | –ö–æ–ª-–≤–æ –∑–∞–∫–∞–∑–æ–≤ (–º–∞–∫—Å 100) | 20 |
| `filter[orders][state]` | NEW, PICKUP, DELIVERY, etc | NEW |
| `filter[orders][status]` | APPROVED_BY_BANK, ACCEPTED_BY_MERCHANT, etc | APPROVED_BY_BANK |
| `filter[orders][creationDate][$ge]` | –î–∞—Ç–∞ –æ—Ç (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã) | 1478736000000 |
| `filter[orders][creationDate][$le]` | –î–∞—Ç–∞ –¥–æ (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã) | 1479945600000 |

**–°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤:**
- `APPROVED_BY_BANK` - –ù–æ–≤—ã–π –∑–∞–∫–∞–∑, –Ω—É–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å ‚úÖ
- `ACCEPTED_BY_MERCHANT` - –ü—Ä–∏–Ω—è—Ç –ø—Ä–æ–¥–∞–≤—Ü–æ–º
- `COMPLETED` - –ó–∞–≤–µ—Ä—à–µ–Ω
- `CANCELLED` - –û—Ç–º–µ–Ω–µ–Ω
- `CANCELLING` - –í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ—Ç–º–µ–Ω—ã
- `KASPI_DELIVERY_RETURN_REQUESTED` - –û–∂–∏–¥–∞–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞
- `RETURNED` - –í–æ–∑–≤—Ä–∞—â–µ–Ω

**–°–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤:**
- `NEW` - –ù–æ–≤—ã–π
- `SIGN_REQUIRED` - –ù—É–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `PICKUP` - –°–∞–º–æ–≤—ã–≤–æ–∑
- `DELIVERY` - –í–∞—à–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
- `KASPI_DELIVERY` - Kaspi –î–æ—Å—Ç–∞–≤–∫–∞
- `ARCHIVE` - –ê—Ä—Ö–∏–≤–Ω—ã–π

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:**
```http
GET /shop/api/v2/orders?page[number]=0&page[size]=20&filter[orders][status]=APPROVED_BY_BANK
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: 56Pj6wkGBX34/05TUMV1ptxrGCa1ZdMkderQA1+Gtr0=
```

---

### **2. –ü—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–∫–∞–∑–∞:**

**Endpoint:**
```http
POST /shop/api/v2/orders
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: <—Ç–æ–∫–µ–Ω>
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "data": {
    "type": "orders",
    "id": "orderID",
    "attributes": {
      "code": "ordercode",
      "status": "ACCEPTED_BY_MERCHANT"
    }
  }
}
```

---

### **3. –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞:**

**Endpoint:**
```http
POST /shop/api/v2/orders
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: <—Ç–æ–∫–µ–Ω>
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "data": {
    "type": "orders",
    "id": "orderID",
    "attributes": {
      "code": "ordercode",
      "status": "CANCELLED",
      "cancellationReason": "MERCHANT_OUT_OF_STOCK"
    }
  }
}
```

**–ü—Ä–∏—á–∏–Ω—ã –æ—Ç–º–µ–Ω—ã:**
- `BUYER_CANCELLATION_BY_MERCHANT` - –û—Ç–∫–∞–∑ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è
- `BUYER_NOT_REACHABLE` - –ù–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å—Å—è
- `MERCHANT_OUT_OF_STOCK` - –¢–æ–≤–∞—Ä–∞ –Ω–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏

---

### **4. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (—Å—Ç–∞—Ç—É—Å "–í—ã–¥–∞–Ω"):**

**–≠—Ç–∞–ø 1: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é**
```http
POST /shop/api/v2/orders
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: <—Ç–æ–∫–µ–Ω>
X-Security-Code:
X-Send-Code: true
```

**–≠—Ç–∞–ø 2: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –∫–æ–¥–æ–º –æ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—è**
```http
POST /shop/api/v2/orders
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: <—Ç–æ–∫–µ–Ω>
X-Security-Code: 1234
X-Send-Code: true
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–æ–±–∞ —ç—Ç–∞–ø–∞):**
```json
{
  "data": {
    "type": "orders",
    "id": "orderID",
    "attributes": {
      "code": "ordercode",
      "status": "COMPLETED"
    }
  }
}
```

---

### **5. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Å—Ç–∞–≤–µ –∑–∞–∫–∞–∑–∞:**

**Endpoint:**
```http
GET /shop/api/v2/orders/{orderID}/entries
Host: kaspi.kz
Content-Type: application/vnd.api+json
X-Auth-Token: <—Ç–æ–∫–µ–Ω>
```

---

## üì¶ –†–ê–ë–û–¢–ê –° –¢–û–í–ê–†–ê–ú–ò (XML –ü–†–ê–ô–°-–õ–ò–°–¢):

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞:**

Kaspi –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∞—à XML –ø—Ä–∞–π—Å-–ª–∏—Å—Ç **–∫–∞–∂–¥—ã–µ 60 –º–∏–Ω—É—Ç**, –µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç–µ:**
1. –ö–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí –¢–æ–≤–∞—Ä—ã ‚Üí –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∞–π—Å-–ª–∏—Å—Ç
2. –í—ã–±—Ä–∞—Ç—å "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞"
3. –£–∫–∞–∑–∞—Ç—å URL –≤–∞—à–µ–≥–æ XML —Ñ–∞–π–ª–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ XML —Ñ–∞–π–ª–∞:**

```xml
<?xml version="1.0" encoding="utf-8"?>
<kaspi_catalog date="2025-10-08T12:00:00"
              xmlns="kaspiShopping"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="kaspiShopping http://kaspi.kz/kaspishopping.xsd">
   <company>Al-Style</company>
   <merchantid>01</merchantid>
   <offers>
       <offer sku="XK-100UB">
           <model>iPhone 13 Pro 256GB</model>
           <brand>Apple</brand>
           <availabilities>
               <availability 
                 available="yes" 
                 storeId="myFavoritePickupPoint1" 
                 preOrder="0" 
                 stockCount="25"/>
           </availabilities>
           <price>450000</price>
       </offer>
   </offers>
</kaspi_catalog>
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
- `sku` - –ê—Ä—Ç–∏–∫—É–ª (–º–∞–∫—Å 20 —Å–∏–º–≤–æ–ª–æ–≤, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `model` - –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- `brand` - –ë—Ä–µ–Ω–¥
- `available` - yes/no
- `storeId` - –ö–æ–¥ —Å–∫–ª–∞–¥–∞ (–∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞)
- `stockCount` - –û—Å—Ç–∞—Ç–∫–∏
- `price` - –¶–µ–Ω–∞ (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –±–µ–∑ –ù–î–°)

**preOrder** - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –ø—Ä–µ–¥–∑–∞–∫–∞–∑–∞ (0-30)

**–°—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
```
http://kaspi.kz/kaspishopping.xsd
```

---

## üö® –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø:

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: Timeout –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –±–∞–∑–æ–≤—ã–π URL
2. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç endpoint (/orders)
3. ‚ùå –¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
4. ‚ùå API –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –≤ –∫–∞–±–∏–Ω–µ—Ç–µ

**–†–µ—à–µ–Ω–∏–µ:**
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
url = "https://kaspi.kz/shop/api/v2"

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
url = "https://kaspi.kz/shop/api/v2/orders"
```

---

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: 401 Unauthorized**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω
2. –¢–æ–∫–µ–Ω –∏—Å—Ç—ë–∫
3. –¢–æ–∫–µ–Ω –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–π–¥–∏—Ç–µ –≤ –∫–∞–±–∏–Ω–µ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ API
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π

---

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: 403 Forbidden**

**–ü—Ä–∏—á–∏–Ω—ã:**
1. API –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
2. –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ endpoint

**–†–µ—à–µ–Ω–∏–µ:**
- –°–≤—è–∂–∏—Ç–µ—Å—å —Å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Kaspi: **2323** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

---

## ‚úÖ –ü–†–û–í–ï–†–ï–ù–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø:

### **–î–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:**

```python
# config.py
KASPI_API_URL = "https://kaspi.kz/shop/api/v2"
KASPI_TOKEN = "56Pj6wkGBX34/05TUMV1ptxrGCa1ZdMkderQA1+Gtr0="

KASPI_HEADERS = {
    'Content-Type': 'application/vnd.api+json',
    'X-Auth-Token': KASPI_TOKEN
}

# Endpoints:
ORDERS_ENDPOINT = f"{KASPI_API_URL}/orders"
PRODUCTS_ENDPOINT = f"{KASPI_API_URL}/products"
```

---

## üîß –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω** –≤ –∫–∞–±–∏–Ω–µ—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
2. ‚úÖ **–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ API –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω**
3. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ endpoint'–∞–º–∏
4. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ–π GET –∑–∞–ø—Ä–æ—Å
5. ‚ö†Ô∏è **–ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - —Å–≤—è–∑–∞—Ç—å—Å—è —Å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π 2323

---

## üìû –¢–ï–•–ü–û–î–î–ï–†–ñ–ö–ê:

- **–¢–µ–ª–µ—Ñ–æ–Ω**: 2323 (–±–µ—Å–ø–ª–∞—Ç–Ω–æ —Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ)
- **–ß–∞—Ç**: –í –∫–∞–±–∏–Ω–µ—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
- **Email**: –ß–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤ –∫–∞–±–∏–Ω–µ—Ç–µ

---

## üìù –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:

### **–õ–∏–º–∏—Ç—ã API:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ XML: –∫–∞–∂–¥—ã–µ 60 –º–∏–Ω—É—Ç
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏: 1-5 —Å–µ–∫—É–Ω–¥

### **–¢–∞–π–º–∞—É—Ç—ã:**
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π timeout: 10-30 —Å–µ–∫—É–Ω–¥
- –î–ª—è –∑–∞–∫–∞–∑–æ–≤: 30 —Å–µ–∫—É–Ω–¥
- –î–ª—è —Ç–æ–≤–∞—Ä–æ–≤: 60 —Å–µ–∫—É–Ω–¥

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞**: 2025-10-08
**–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Kaspi + –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
