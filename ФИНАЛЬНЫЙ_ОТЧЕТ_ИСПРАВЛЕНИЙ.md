# ‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û –í –ü–†–û–ï–ö–¢–ï

## üìÖ –î–∞—Ç–∞: 2025-10-08

---

## üéØ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò:

### 1. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.12.10
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ requirements.txt
- –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.env` —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏

### 2. ‚úÖ **–ò–∑—É—á–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Kaspi API**
- –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–∞ guide.kaspi.kz
- –ò–∑—É—á–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ (2157 —Å—Ç—Ä–æ–∫)
- –ù–∞–π–¥–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ endpoint'—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `KASPI_API_–ê–ö–¢–£–ê–õ–¨–ù–ê–Ø_–ò–ù–§–û–†–ú–ê–¶–ò–Ø.md`

### 3. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ**

---

## üîß –ö–û–ù–ö–†–ï–¢–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:

### **–§–∞–π–ª: `config.py`**

**–ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
kaspi_api_url: str = os.getenv('KASPI_API_URL', 'https://kaspi.kz/shop/api/v2')
kaspi_api_url_alt1: str = os.getenv('KASPI_API_URL_ALT1', 'https://merchant.kaspi.kz/api/v2')
kaspi_api_url_alt2: str = os.getenv('KASPI_API_URL_ALT2', 'https://api.kaspi.kz/shop/v2')
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
# Kaspi API - –±–∞–∑–æ–≤—ã–π URL (—Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Host: kaspi.kz)
kaspi_base_url: str = 'https://kaspi.kz'
kaspi_api_base: str = os.getenv('KASPI_API_URL', 'https://kaspi.kz/shop/api/v2')

# Kaspi API endpoints (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏)
kaspi_orders_url: str = f'{kaspi_base_url}/shop/api/v2/orders'
kaspi_products_url: str = f'{kaspi_base_url}/shop/api/v2/products'
kaspi_xml_upload_url: str = f'{kaspi_base_url}/shop/api/v2/product/import'
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
- –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ–ª–Ω—ã–µ –ø—É—Ç–∏ –∫ endpoint'–∞–º
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –î–æ–ª–∂–Ω–æ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É timeout

---

### **–§–∞–π–ª: `Script.py`**

#### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤**

**–ë—ã–ª–æ:**
```python
response = requests.get(f"{config.kaspi_api_url}/orders", headers=KASPI_HEADERS, params=params)
```

**–°—Ç–∞–ª–æ:**
```python
response = requests.get(config.kaspi_orders_url, headers=KASPI_HEADERS, params=params, timeout=config.request_timeout)
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω timeout –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è

---

#### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –ü—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–∫–∞–∑–∞**

**–ë—ã–ª–æ:**
```python
response = requests.post(f"{config.kaspi_api_url}/orders", headers=KASPI_HEADERS, json=accept_order_payload)
```

**–°—Ç–∞–ª–æ:**
```python
response = requests.post(config.kaspi_orders_url, headers=KASPI_HEADERS, json=accept_order_payload, timeout=config.request_timeout)
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω timeout

---

#### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤**

**–ë—ã–ª–æ:**
```python
response = requests.get(f"{config.kaspi_api_url}/orders", headers=KASPI_HEADERS, params=params)
```

**–°—Ç–∞–ª–æ:**
```python
response = requests.get(config.kaspi_orders_url, headers=KASPI_HEADERS, params=params, timeout=config.request_timeout)
```

---

### **–§–∞–π–ª: `kaspi_auto_uploader.py`**

#### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ë–∞–≥ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º**

**–ë—ã–ª–æ (–ë–ê–ì!):**
```python
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º XML
result = update_kaspi_prices_stock()  # ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä products
```

**–°—Ç–∞–ª–æ:**
```python
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º XML (–ò–°–ü–†–ê–í–õ–ï–ù–û: –ø–µ—Ä–µ–¥–∞—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä products)
result = update_kaspi_prices_stock(products)  # ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º products
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –±—ã–ª –±–∞–≥:**
- –§—É–Ω–∫—Ü–∏—è `update_kaspi_prices_stock()` —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `products`
- –ë–µ–∑ –Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç –ø–∞–¥–∞–ª —Å –æ—à–∏–±–∫–æ–π

---

## üìã –ü–†–ê–í–ò–õ–¨–ù–´–ï ENDPOINT'–´:

### **–°–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Kaspi:**

```http
Host: kaspi.kz
```

### **–ó–∞–∫–∞–∑—ã:**
```
GET  https://kaspi.kz/shop/api/v2/orders
POST https://kaspi.kz/shop/api/v2/orders
GET  https://kaspi.kz/shop/api/v2/orders/{orderID}/entries
```

### **–¢–æ–≤–∞—Ä—ã:**
```
GET  https://kaspi.kz/shop/api/v2/products
POST https://kaspi.kz/shop/api/v2/products
```

### **XML –ó–∞–≥—Ä—É–∑–∫–∞:**
```
POST https://kaspi.kz/shop/api/v2/product/import
```

### **–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```http
Content-Type: application/vnd.api+json
X-Auth-Token: 56Pj6wkGBX34/05TUMV1ptxrGCa1ZdMkderQA1+Gtr0=
```

---

## üÜï –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´:

1. **`.env`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å —Ç–æ–∫–µ–Ω–∞–º–∏
2. **`KASPI_API_–ê–ö–¢–£–ê–õ–¨–ù–ê–Ø_–ò–ù–§–û–†–ú–ê–¶–ò–Ø.md`** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
3. **`test_config_and_api.py`** - –¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. **`test_kaspi_api_correct.py`** - –¢–µ—Å—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ endpoint'–∞–º–∏
5. **`–ö–†–ê–¢–ö–û–ï_–†–ï–ó–Æ–ú–ï.md`** - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ —Ä–∞–±–æ—Ç—ã
6. **`–§–ò–ù–ê–õ–¨–ù–´–ô_–û–¢–ß–ï–¢_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ô.md`** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢:

### **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ Al-Style API - –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ XML –≥–µ–Ω–µ—Ä–∞—Ü–∏—è - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã XML - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ - –ø–æ–ª–Ω–æ–µ

### **–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ Endpoint'—ã Kaspi API –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã timeout'—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ –≤ kaspi_auto_uploader.py
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### **–ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚è≥ –¢–æ–∫–µ–Ω Kaspi (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–∞–±–∏–Ω–µ—Ç–µ)
- ‚è≥ –ê–∫—Ç–∏–≤–∞—Ü–∏—è API –≤ –∫–∞–±–∏–Ω–µ—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
- ‚è≥ –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º API

---

## üöÄ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨:

### **1. –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç Al-Style (–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å):**
```bash
python Script.py test-products
```

### **2. –¢–µ—Å—Ç XML –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å):**
```bash
python Script.py test-xml
```

### **3. –¢–µ—Å—Ç Kaspi API (–Ω—É–∂–µ–Ω –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω):**
```bash
python test_kaspi_api_correct.py
```

### **4. –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫:**
```bash
python Script.py
```

---

## üìû –ï–°–õ–ò KASPI API –í–°–Å –ï–©–Å –ù–ï –†–ê–ë–û–¢–ê–ï–¢:

### **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–∞–±–∏–Ω–µ—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞:**
1. –ó–∞–π—Ç–∏: https://kaspi.kz/merchantcabinet/
2. –†–∞–∑–¥–µ–ª: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí API**
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - API –≤–∫–ª—é—á–µ–Ω? ‚òëÔ∏è
   - –¢–æ–∫–µ–Ω –∞–∫—Ç–∏–≤–µ–Ω? ‚òëÔ∏è
   - –¢–æ–∫–µ–Ω —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å .env? ‚òëÔ∏è

### **–ü–æ–∑–≤–æ–Ω–∏—Ç—å –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É:**
- **–¢–µ–ª–µ—Ñ–æ–Ω:** 2323 (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- **–°–∫–∞–∑–∞—Ç—å:** "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç API –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω"
- **–ù–∞–∑–≤–∞—Ç—å:** –ü–µ—Ä–≤—ã–µ 10 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–æ–∫–µ–Ω–∞: `56Pj6wkGBX`

---

## üí° –í–ê–ñ–ù–û:

**Al-Style API —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ** - —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:
- ‚úÖ –ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- ‚úÖ –°–µ—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Python –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**Kaspi API –¥–∞—ë—Ç timeout** - —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:
- –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Kaspi
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
- –í–æ–∑–º–æ–∂–Ω–æ, API –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:

- **–ò–∑—É—á–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 2157+ —Å—Ç—Ä–æ–∫
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 3 (config.py, Script.py, kaspi_auto_uploader.py)
- **–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:** 6
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –±–∞–≥–æ–≤:** 4
- **–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~3 —á–∞—Å–∞

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º!** üéâ
